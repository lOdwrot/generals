(this["webpackJsonpgenerals-front"]=this["webpackJsonpgenerals-front"]||[]).push([[0],{119:function(e,t,a){e.exports={"audio-panel":"AudioControl_audio-panel__1D5FQ","slider-wrapper":"AudioControl_slider-wrapper__3K4Ro"}},181:function(e,t,a){e.exports=a(375)},186:function(e,t,a){},216:function(e,t){},350:function(e,t,a){},374:function(e,t,a){},375:function(e,t,a){"use strict";a.r(t);var n,r,o=a(0),c=a.n(o),i=a(9),l=a.n(i),s=(a(186),a(187),a(159)),u=a.n(s),m={address:"http://localhost:5500"},d=a(42),p=a(11),f={userName:"p1",socketId:"",roomId:""},g=a(85),v=[],y=a(56),b=function(e){return{type:"game.setActiveField",payload:e}},h=function(e){return{type:"game.setCommands",payload:e}},E=function(e){return{type:"game.removeCommands",payload:e}},w=function(e){return{type:"game.setPlayerRole",payload:e}},O={players:[],board:[[]],activeField:{x:-1,y:-1},commands:[],userColors:{},usersStats:{},tourCounter:0,playerRole:"lobby",moveType:"all"},j={privateSettings:{},gameSettings:{mapWidth:20,mapHeight:20,gameMode:"Conquest",nonAggression:20,castlesDensity:.5,mountainDensity:.5,castleProduction:1,fieldProduction:25,turnDuration:1e3}},_={user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user.setName":return Object(p.a)({},e,{userName:t.payload});case"user.setUser":return Object(p.a)({},e,{},t.payload);default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages.addMessage":return[].concat(Object(g.a)(e),[t.payload]);default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"game.setPlayers":return Object(p.a)({},e,{players:t.payload,userColors:t.payload.reduce((function(e,t){return Object(p.a)({},e,Object(y.a)({},t.socketId,t.color))}),{})});case"game.setBoard":return Object(p.a)({},e,{board:t.payload});case"game.setActiveField":return Object(p.a)({},e,{activeField:t.payload,moveType:"all"});case"game.setCommands":return Object(p.a)({},e,{commands:t.payload});case"game.removeCommands":return Object(p.a)({},e,{commands:e.commands.filter((function(e){return!t.payload.includes(e.id)}))});case"game.setPlayerRole":return Object(p.a)({},e,{playerRole:t.payload});case"game.updateStats":return Object(p.a)({},e,{},t.payload);case"game.setMoveType":return Object(p.a)({},e,{moveType:t.payload});default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REPLACE_GAME_SETTING":return Object(p.a)({},e,{gameSettings:t.payload});case"MODIFY_GAME_SETTING":var a=t.payload,n=a.settingName,r=a.value;return Object(p.a)({},e,{gameSettings:Object(p.a)({},e.gameSettings,Object(y.a)({},n,r))});default:return e}}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(d.c)(_)(e,t)},x=a(161),N=(a(220),Object(d.a)(x.a)(d.d)(C)),S=a(38),I="".concat(".","/battleStart1.mp3"),k="".concat(".","/open.mp3"),M=("".concat(".","/cnquest.mp3"),["".concat(".","/peacefullMusic.mp3"),"".concat(".","/peacefullMusic2.mp3"),"".concat(".","/peacefullMusic3.mp3"),"".concat(".","/peacefullMusic4.mp3")]),A="".concat(".","/battleMusic.mp3"),D="".concat(".","/lost.mp3"),T="".concat(".","/won.mp3"),R=1,L=function(e){n&&n.pause(),(n=new Audio(e)).volume=R,n.play()},P=function(e){r&&r.pause(),(r=new Audio(e)).volume=R,r.play()},G=u()(m.address),B=function(e){return G.emit("eraseCommands",e)};G.on("startBattle",(function(){N.dispatch(b({x:-1,y:-1})),N.dispatch(h([])),L(I),setTimeout((function(){return L(Object(S.sample)(M))}),6e3),N.dispatch(w("fighter"))})),G.on("updateStats",(function(e){return N.dispatch(function(e){return{type:"game.updateStats",payload:e}}(e))})),G.on("loser",(function(){P(D),N.dispatch(w("spectator"))})),G.on("winner",(function(e){L(T),N.dispatch(w("spectator"))})),G.on("endOfPeace",(function(){L(A)})),G.on("updateBoard",(function(e){var t=N.getState().user.socketId;e.flat().filter((function(e){return e.owner===t})).forEach((function(t){for(var a=t.x,n=t.y,r=a-1;r<=a+1;r++)for(var o=n-1;o<=n+1;o++)e[o]&&e[o][r]&&(e[o][r].isVisible=!0)})),N.dispatch(function(e){return{type:"game.setBoard",payload:e}}(e))})),G.on("removeCommands",(function(e){return N.dispatch(E(e))}));G.on("chat",(function(e){return N.dispatch({type:"messages.addMessage",payload:e})}));var F=function(){return G.emit("createRoom",N.getState().user.userName)};G.on("setRoomSettings",(function(e){return N.dispatch(function(e){return{type:"REPLACE_GAME_SETTING",payload:e}}(e))})),G.on("joined",(function(e){return N.dispatch(function(e){return{type:"user.setUser",payload:e}}(e))})),G.on("refreshPlayersInRoom",(function(e){return N.dispatch(function(e){return{type:"game.setPlayers",payload:e}}(e))})),G.on("noRoom",(function(){return window.alert("No room with given id")}));var U=a(39),q=a(379),H=a(381),V=a(120),W=a(5),J=a(86),Y=a.n(J),K=function(e){return e.user},Q=q.a.Item,X=function(){var e=Object(W.b)(),t=Object(o.useState)(""),a=Object(U.a)(t,2),n=a[0],r=a[1],i=Object(o.useState)(!1),l=Object(U.a)(i,2),s=l[0],u=l[1],m=Object(W.c)(K),d=!!m.roomId;return c.a.createElement("div",{className:Y.a["lobby-wrapper"]},c.a.createElement("div",{className:Y.a["lobby-content-box"]},c.a.createElement("h3",{className:Y.a.header},"Overlight Generals"),c.a.createElement(Q,{help:"User Name"},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(H.a,{onChange:function(t){return e({type:"user.setName",payload:t.target.value})},value:m.userName,placeholder:"User Name",disabled:s||d}),c.a.createElement(V.a,{type:"primary",disabled:s||d,onClick:function(){return u(!0)}},"Confirm"))),c.a.createElement(V.a,{disabled:m.roomId,onClick:F,style:{width:"255px"}},"Create Room"),!m.roomId&&c.a.createElement(Q,{help:"Room ID to join"},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(H.a,{placeholder:"Room ID",onChange:function(e){return r(e.target.value)}}),c.a.createElement(V.a,{onClick:function(){return function(e){return G.emit("join",{roomId:e,userName:N.getState().user.userName})}(n)}},"Join"))),m.roomId&&c.a.createElement(Q,{help:"Room ID"},c.a.createElement(H.a,{value:m.roomId}))))},$=function(e){return e.messages},z=a(67),Z=a.n(z),ee=function(){var e=Object(o.useState)(""),t=Object(U.a)(e,2),a=t[0],n=t[1],r=Object(o.useState)(!1),i=Object(U.a)(r,2),l=i[0],s=i[1],u=Object(W.c)($);return c.a.createElement("div",{className:Z.a["chat-wrapper"]},c.a.createElement("div",{onClick:function(){return s(!l)},className:Z.a["chat-header"]},"Room Chat"),l&&c.a.createElement("div",null,c.a.createElement("div",{className:Z.a["chat-history"]},u.map((function(e,t){return c.a.createElement("div",{key:t},e)}))),c.a.createElement("div",{className:Z.a["new-message"]},c.a.createElement(H.a,{placeholder:"Message....",value:a,onChange:function(e){return n(e.target.value)}}),c.a.createElement(V.a,{onClick:function(){var e;e=a,G.emit("sendMessage",e),n("")}},"Send Message"))))},te=function(e){return e.game.players},ae=function(e){return e.game.board},ne=function(e){return e.game.activeField},re=function(e){return e.game.commands},oe=function(e){return e.game.userColors},ce=function(e){return e.game.playerRole},ie=function(e){return e.game.usersStats},le=function(e){return e.game.tourCounter},se=function(e){return e.game.moveType},ue=(a(350),a(1)),me=a.n(ue),de=a(170),pe=a.n(de),fe=function(e){var t=re(N.getState()),a=ae(N.getState()),n=ne(N.getState()),r=se(N.getState()),o=n.x,c=n.y,i=ve(o,c,e),l=i.x,s=i.y,u=i.direction;if(ge(l,s,a)&&ge(o,c,a)){var m=a[s][l];if(!m.isVisible||"mountain"!==m.type){var d,p={from:{x:o,y:c},direction:u,id:pe()(),type:"all"===r?"MOVE_ALL":"MOVE_HALF"};d=p,G.emit("addCommand",d),N.dispatch(b({x:l,y:s})),N.dispatch(h([].concat(Object(g.a)(t),[p])))}}},ge=function(e,t,a){return e>=0&&e<a[0].length&&t>=0&&t<a.length},ve=function(e,t,a){var n;return"w"===a&&(n="u",t--),"s"===a&&(t++,n="d"),"a"===a&&(e--,n="l"),"d"===a&&(e++,n="r"),{x:e,y:t,direction:n}},ye=function(e,t){return N.dispatch(b({x:e,y:t}))},be=["w","s","a","d"],he=function(e){var t=e.key;if(be.includes(t))return fe(t);"e"===t&&Ee(),"q"===t&&we()},Ee=function(){var e=re(N.getState());if(0!==e.length){var t=e[e.length-1],a=[t.id];if(t.from){var n=t.from,r=n.x,o=n.y;ye(r,o)}B(a),N.dispatch(E(a))}},we=function(){var e=re(N.getState());if(0!==e.length){var t=e.map((function(e){return e.id}));B(t),N.dispatch(E(t))}},Oe=c.a.memo((function(e){var t=e.field,a=e.commands,n=e.seeAll,r=Object(W.c)(K),o=Object(W.c)(oe),i=Object(W.c)(ne),l=Object(W.c)(se),s=t.type,u=t.owner,m=t.units,d=t.x,p=t.y,f=t.isVisible,g=r.socketId===u,v=i.x===d&&i.y===p;return c.a.createElement("div",{onClick:function(){if(g){if(console.log(l),v&&"all"===l)return N.dispatch({type:"game.setMoveType",payload:"half"});ye(d,p)}},style:{backgroundColor:n||!0!==!f?"n"===u?"grey":o[u]:"#202020",backgroundImage:je(s,f||n)},className:me()("board-tile",{clicable:g,"selected-field":v})},v&&"half"===l?"50%":(n||!!f)&&null!=m&&m,a.map((function(e){return c.a.createElement("div",{className:_e(e)},function(e){switch(e.direction){case"u":return"\u2191";case"d":return"\u2193";case"l":return"\u2190";case"r":return"\u2192";default:return"x"}}(e))})))}),(function(e,t){return!!(Object(S.isEqual)(e.commands,t.commands)&&Object(S.isEqual)(e.field,t.field)&&Object(S.isEqual)(e.seeAll,t.seeAll))}));function je(e,t){var a="";return(t=t||window.debug)||"castle"!==e&&"mountain"!==e?"castle"===e?a="/city.png":"mountain"===e?a="/mountain.png":t&&"capitol"===e&&(a="/crown.png"):a="/obstacle.png","url(".concat("."+a,")")}function _e(e){switch(e.direction){case"u":return"arrow-container arrow-up";case"d":return"arrow-container arrow-down";case"l":return"arrow-container arrow-left";case"r":return"arrow-container arrow-right";default:return alert("command without direction")}}var Ce=function(){var e=Object(W.c)(ae),t=Object(W.c)(re),a=Object(W.c)(ce),n=function(e){var t=e.movementX,a=e.movementY;if(1===e.buttons){var n=document.getElementById("board"),r=n.style,o=r.left,c=r.top;n.style.left=Number(o.slice(0,-2))+t+"px",n.style.top=Number(c.slice(0,-2))+a+"px"}},r=function(e){var t=e.deltaY,a=document.getElementById("board"),n=Number(a.style.transform.slice(6,-1))+(t>0?-.1:.1);n>2||n<.5||(a.style.transform="scale(".concat(String(n).padEnd(3,".0"),")"))};Object(o.useEffect)((function(){return window.addEventListener("keypress",he),window.addEventListener("mousemove",n),window.addEventListener("mousewheel",r),function(){window.removeEventListener("keypress",he),window.removeEventListener("mousemove",n),window.removeEventListener("mousewheel",r)}}),[]);var i=t.reduce((function(e,t){var a="".concat(t.from.x,"-").concat(t.from.y);return e[a]||(e[a]=[]),e[a].push(t),e}),{});return c.a.createElement("div",null,c.a.createElement("div",{id:"board",className:"board-container",style:{left:"10px",top:"10px",transform:"scale(1)"}},e.map((function(e,t){return c.a.createElement("div",{key:t,className:"board-row "},e.map((function(e,t){return c.a.createElement(Oe,{key:t,seeAll:"spectator"===a||!0===window.debug,commands:i["".concat(e.x,"-").concat(e.y)]||[],field:e})})))}))))},xe=a(87),Ne=a.n(xe),Se=a(382),Ie=a(378),ke=a(380),Me=function(e){return e.settings.gameSettings},Ae=q.a.Item,De=Se.a.Option,Te=[{name:"Conquest",description:"Capture all opponent capitols"}],Re=[{name:"Units Collector",descroption:"Gather the biggest army in whole state"},{name:"King of Castles",descroption:"Capture the castles around the whole world"},{name:"Territory Wars",descroption:"Rule the whole world"}],Le=Object(S.debounce)((function(e){return function(e){return G.emit("setRoomSettings",e)}(e)}),500),Pe=function(){var e,t=Object(W.c)(Me),a=Object(W.c)(K),n=Object(W.c)(te),r=Object(W.b)(),o=a.socketId===(null===(e=n[0])||void 0===e?void 0:e.socketId),i=t.mapWidth,l=t.mapHeight,s=t.gameMode,u=t.nonAggression,m=t.castlesDensity,d=t.mountainDensity,p=t.castleProduction,f=t.fieldProduction,g=t.turnDuration,v=function(e,t){r(function(e,t){return{type:"MODIFY_GAME_SETTING",payload:{settingName:e,value:t}}}(e,t)),Le(Me(N.getState()))},y=function(){return e=t,G.emit("start",e);var e};return a.roomId?c.a.createElement("div",{className:Ne.a["settings-wrapper"]},c.a.createElement("div",{className:Ne.a["settings-content-box"]},c.a.createElement(V.a,{onClick:function(){return y()},type:"primary",style:{width:"300px",marginTop:"10px"},disabled:!o},"Battle!"),c.a.createElement("div",{className:Ne.a["settings-list"]},c.a.createElement(Ie.a,null,"Only Host Can Modify This Settings"),c.a.createElement(Ie.a,null,"Map Dimmensions"),c.a.createElement("div",null,c.a.createElement(Ae,{help:"Map Width: ".concat(i)},c.a.createElement(ke.a,{disabled:!o,min:15,max:40,value:i,onChange:function(e){return v("mapWidth",e)}})),c.a.createElement(Ae,{help:"Map Height: ".concat(l)},c.a.createElement(ke.a,{disabled:!o,min:15,max:40,value:l,onChange:function(e){return v("mapHeight",e)}}))),c.a.createElement(Ie.a,null,"Game Rules"),c.a.createElement(Ae,{help:"Game Mode"},c.a.createElement(Se.a,{disabled:!o,value:s,onChange:function(e){return v("gameMode",e)}},Te.map((function(e){return c.a.createElement(De,{value:e.name,key:e.name},e.name)})),Re.map((function(e){return c.a.createElement(De,{value:e.name,key:e.name,disabled:!0},e.name)})))),c.a.createElement(Ae,{help:"Duration Of Non-Aggression Pact: ".concat(u)},c.a.createElement(ke.a,{disabled:!o,min:0,max:300,step:10,value:u,onChange:function(e){return v("nonAggression",e)}})),c.a.createElement(Ie.a,null,"Map Objects"),c.a.createElement("div",null,c.a.createElement(Ae,{help:"Castles Density: ".concat(m)},c.a.createElement(ke.a,{disabled:!o,min:0,max:1,step:.1,value:m,onChange:function(e){return v("castlesDensity",e)}})),c.a.createElement(Ae,{help:"Mountains Density: ".concat(d)},c.a.createElement(ke.a,{disabled:!o,min:0,max:1,step:.1,value:d,onChange:function(e){return v("mountainDensity",e)}}))),c.a.createElement(Ie.a,null,"Other"),c.a.createElement("div",null,c.a.createElement(Ae,{help:"Castles Units Production Time: ".concat(p)},c.a.createElement(ke.a,{disabled:!o,min:1,max:60,step:1,value:p,onChange:function(e){return v("castleProduction",e)}})),c.a.createElement(Ae,{help:"Field Units Production Time: ".concat(f)},c.a.createElement(ke.a,{disabled:!o,min:1,max:60,step:1,value:f,onChange:function(e){return v("fieldProduction",e)}})),c.a.createElement(Ae,{help:"Resp Turn Duration: ".concat(g," ms")},c.a.createElement(ke.a,{disabled:!o,min:250,max:3e3,step:250,value:g,onChange:function(e){return v("turnDuration",e)}})))))):null},Ge=a(68),Be=a.n(Ge),Fe=function(){var e=Object(W.c)(te),t=Object(W.c)(oe),a=Object(W.c)(ie),n=Object(W.c)(le),r=Object(W.c)(ce),o=Object(W.c)(Me).nonAggression,i=Object(W.b)();return c.a.createElement("div",{className:Be.a["info-panel"]},c.a.createElement("div",{className:me()(Be.a["grid-container"])},c.a.createElement("div",null),c.a.createElement("div",{className:Be.a["room-header"]},"Player"),c.a.createElement("div",null,"Army"),c.a.createElement("div",null,"Lands"),e.map((function(e){var n,r;return c.a.createElement(c.a.Fragment,{key:e.socketId},c.a.createElement("div",null,c.a.createElement("div",{className:Be.a["color-box"],style:{background:t[e.socketId]}})),c.a.createElement("div",null,"".concat(e.userName)),c.a.createElement("div",null,(null===(n=a[e.socketId])||void 0===n?void 0:n.units)||0),c.a.createElement("div",null,(null===(r=a[e.socketId])||void 0===r?void 0:r.lands)||0))}))),c.a.createElement("div",null,"Tour: ",n," / ",o),c.a.createElement("div",null,"spectator"===r&&c.a.createElement(V.a,{onClick:function(){return i(w("lobby"))},type:"danger",style:{width:"100%"}},"Back To Lobby!")))},Ue=a(119),qe=a.n(Ue),He=a(383),Ve=function(){var e=Object(o.useState)(100),t=Object(U.a)(e,2),a=t[0],i=t[1],l=function(e){i(e),function(e){R=e,n&&(n.volume=R),r&&(r.volume=R)}(e/100)};return c.a.createElement("div",{className:qe.a["audio-panel"]},c.a.createElement(V.a,{onClick:function(){return l(a?0:100)},icon:c.a.createElement(He.a,null)}),c.a.createElement("div",{className:qe.a["slider-wrapper"]},c.a.createElement(ke.a,{min:0,max:100,onChange:l,value:a})))};a(374);var We=function(){var e=Object(W.c)(ce);return Object(o.useEffect)((function(){L(k)}),[]),c.a.createElement("div",null,c.a.createElement(Ve,null),c.a.createElement(Fe,null),c.a.createElement(ee,null),"lobby"===e&&c.a.createElement(c.a.Fragment,null,c.a.createElement(X,null),c.a.createElement(Pe,null)),("fighter"===e||"spectator"===e)&&c.a.createElement(Ce,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(W.a,{store:N},c.a.createElement(We,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},67:function(e,t,a){e.exports={"chat-wrapper":"LiveChat_chat-wrapper__3yyAJ","chat-history":"LiveChat_chat-history__2VHgG","chat-header":"LiveChat_chat-header__1SPj-","new-message":"LiveChat_new-message__1I6jr"}},68:function(e,t,a){e.exports={"info-panel":"GameInfo_info-panel__3NB7p","grid-container":"GameInfo_grid-container__1DJ7y","color-box":"GameInfo_color-box__kQ-B1"}},86:function(e,t,a){e.exports={"lobby-wrapper":"Lobby_lobby-wrapper__lDjyO","lobby-content-box":"Lobby_lobby-content-box__QuG4U",header:"Lobby_header__2r9_D"}},87:function(e,t,a){e.exports={"settings-wrapper":"Settings_settings-wrapper__1-tcm","settings-content-box":"Settings_settings-content-box__38rES","settings-list":"Settings_settings-list__3xNVK"}}},[[181,1,2]]]);
//# sourceMappingURL=main.8157da85.chunk.js.map