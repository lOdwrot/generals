(this["webpackJsonpgenerals-front"]=this["webpackJsonpgenerals-front"]||[]).push([[0],{119:function(e,t,a){e.exports={"audio-panel":"AudioControl_audio-panel__1D5FQ","slider-wrapper":"AudioControl_slider-wrapper__3K4Ro"}},182:function(e,t,a){e.exports=a(375)},187:function(e,t,a){},217:function(e,t){},350:function(e,t,a){},374:function(e,t,a){},375:function(e,t,a){"use strict";a.r(t);var n,r,o=a(0),c=a.n(o),i=a(9),l=a.n(i),s=(a(187),a(188),a(159)),u=a.n(s),m={address:"http://localhost:5500"},d=a(42),p=a(11),f={userName:"p1",socketId:"",roomId:""},g=a(85),v=[],y=a(56),b=function(e){return{type:"game.setActiveField",payload:e}},h=function(e){return{type:"game.setCommands",payload:e}},E=function(e){return{type:"game.removeCommands",payload:e}},w=function(e){return{type:"game.setPlayerRole",payload:e}},O={players:[],board:[[]],activeField:{x:-1,y:-1},commands:[],userColors:{},usersStats:{},tourCounter:0,playerRole:"lobby",moveType:"all"},j={privateSettings:{},gameSettings:{mapWidth:20,mapHeight:20,gameMode:"Conquest",nonAggression:20,castlesDensity:.5,mountainDensity:.5,castleProduction:1,fieldProduction:25,turnDuration:1e3}},_={user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user.setName":return Object(p.a)({},e,{userName:t.payload});case"user.setUser":return Object(p.a)({},e,{},t.payload);default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages.addMessage":return[].concat(Object(g.a)(e),[t.payload]);default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"game.setPlayers":return Object(p.a)({},e,{players:t.payload,userColors:t.payload.reduce((function(e,t){return Object(p.a)({},e,Object(y.a)({},t.socketId,t.color))}),{})});case"game.setBoard":return Object(p.a)({},e,{board:t.payload});case"game.setActiveField":return Object(p.a)({},e,{activeField:t.payload,moveType:"all"});case"game.setCommands":return Object(p.a)({},e,{commands:t.payload});case"game.removeCommands":return Object(p.a)({},e,{commands:e.commands.filter((function(e){return!t.payload.includes(e.id)}))});case"game.setPlayerRole":return Object(p.a)({},e,{playerRole:t.payload});case"game.updateStats":return Object(p.a)({},e,{},t.payload);case"game.setMoveType":return Object(p.a)({},e,{moveType:t.payload});default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REPLACE_GAME_SETTING":return Object(p.a)({},e,{gameSettings:t.payload});case"MODIFY_GAME_SETTING":var a=t.payload,n=a.settingName,r=a.value;return Object(p.a)({},e,{gameSettings:Object(p.a)({},e.gameSettings,Object(y.a)({},n,r))});default:return e}}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(d.c)(_)(e,t)},x=a(161),N=a(162),S=a.n(N),I=Object(d.a)(x.a,S.a)(d.d)(C),k=a(38),M="".concat(".","/battleStart1.mp3"),A="".concat(".","/open.mp3"),D=("".concat(".","/cnquest.mp3"),["".concat(".","/peacefullMusic.mp3"),"".concat(".","/peacefullMusic2.mp3"),"".concat(".","/peacefullMusic3.mp3"),"".concat(".","/peacefullMusic4.mp3")]),T="".concat(".","/battleMusic.mp3"),R="".concat(".","/lost.mp3"),L="".concat(".","/won.mp3"),P=1,G=function(e){n&&n.pause(),(n=new Audio(e)).volume=P,n.play()},B=function(e){r&&r.pause(),(r=new Audio(e)).volume=P,r.play()},F=u()(m.address),U=function(e){return F.emit("eraseCommands",e)};F.on("startBattle",(function(){I.dispatch(b({x:-1,y:-1})),I.dispatch(h([])),G(M),setTimeout((function(){return G(Object(k.sample)(D))}),6e3),I.dispatch(w("fighter"))})),F.on("updateStats",(function(e){return I.dispatch(function(e){return{type:"game.updateStats",payload:e}}(e))})),F.on("loser",(function(){B(R),I.dispatch(w("spectator"))})),F.on("winner",(function(e){G(L),I.dispatch(w("spectator"))})),F.on("endOfPeace",(function(){G(T)})),F.on("updateBoard",(function(e){var t=I.getState().user.socketId;e.flat().filter((function(e){return e.owner===t})).forEach((function(t){for(var a=t.x,n=t.y,r=a-1;r<=a+1;r++)for(var o=n-1;o<=n+1;o++)e[o]&&e[o][r]&&(e[o][r].isVisible=!0)})),I.dispatch(function(e){return{type:"game.setBoard",payload:e}}(e))})),F.on("removeCommands",(function(e){return I.dispatch(E(e))}));F.on("chat",(function(e){return I.dispatch({type:"messages.addMessage",payload:e})}));var q=function(){return F.emit("createRoom",I.getState().user.userName)};F.on("setRoomSettings",(function(e){return I.dispatch(function(e){return{type:"REPLACE_GAME_SETTING",payload:e}}(e))})),F.on("joined",(function(e){return I.dispatch(function(e){return{type:"user.setUser",payload:e}}(e))})),F.on("refreshPlayersInRoom",(function(e){return I.dispatch(function(e){return{type:"game.setPlayers",payload:e}}(e))})),F.on("noRoom",(function(){return window.alert("No room with given id")}));var H=a(39),V=a(379),W=a(381),J=a(120),Y=a(5),K=a(86),Q=a.n(K),X=function(e){return e.user},$=V.a.Item,z=function(){var e=Object(Y.b)(),t=Object(o.useState)(""),a=Object(H.a)(t,2),n=a[0],r=a[1],i=Object(o.useState)(!1),l=Object(H.a)(i,2),s=l[0],u=l[1],m=Object(Y.c)(X),d=!!m.roomId;return c.a.createElement("div",{className:Q.a["lobby-wrapper"]},c.a.createElement("div",{className:Q.a["lobby-content-box"]},c.a.createElement("h3",{className:Q.a.header},"Overlight Generals"),c.a.createElement($,{help:"User Name"},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(W.a,{onChange:function(t){return e({type:"user.setName",payload:t.target.value})},value:m.userName,placeholder:"User Name",disabled:s||d}),c.a.createElement(J.a,{type:"primary",disabled:s||d,onClick:function(){return u(!0)}},"Confirm"))),c.a.createElement(J.a,{disabled:m.roomId,onClick:q,style:{width:"255px"}},"Create Room"),!m.roomId&&c.a.createElement($,{help:"Room ID to join"},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement(W.a,{placeholder:"Room ID",onChange:function(e){return r(e.target.value)}}),c.a.createElement(J.a,{onClick:function(){return function(e){return F.emit("join",{roomId:e,userName:I.getState().user.userName})}(n)}},"Join"))),m.roomId&&c.a.createElement($,{help:"Room ID"},c.a.createElement(W.a,{value:m.roomId}))))},Z=function(e){return e.messages},ee=a(67),te=a.n(ee),ae=function(){var e=Object(o.useState)(""),t=Object(H.a)(e,2),a=t[0],n=t[1],r=Object(o.useState)(!1),i=Object(H.a)(r,2),l=i[0],s=i[1],u=Object(Y.c)(Z);return c.a.createElement("div",{className:te.a["chat-wrapper"]},c.a.createElement("div",{onClick:function(){return s(!l)},className:te.a["chat-header"]},"Room Chat"),l&&c.a.createElement("div",null,c.a.createElement("div",{className:te.a["chat-history"]},u.map((function(e,t){return c.a.createElement("div",{key:t},e)}))),c.a.createElement("div",{className:te.a["new-message"]},c.a.createElement(W.a,{placeholder:"Message....",value:a,onChange:function(e){return n(e.target.value)}}),c.a.createElement(J.a,{onClick:function(){var e;e=a,F.emit("sendMessage",e),n("")}},"Send Message"))))},ne=function(e){return e.game.players},re=function(e){return e.game.board},oe=function(e){return e.game.activeField},ce=function(e){return e.game.commands},ie=function(e){return e.game.userColors},le=function(e){return e.game.playerRole},se=function(e){return e.game.usersStats},ue=function(e){return e.game.tourCounter},me=function(e){return e.game.moveType},de=(a(350),a(1)),pe=a.n(de),fe=a(171),ge=a.n(fe),ve=function(e){var t=ce(I.getState()),a=re(I.getState()),n=oe(I.getState()),r=me(I.getState()),o=n.x,c=n.y,i=be(o,c,e),l=i.x,s=i.y,u=i.direction;if(ye(l,s,a)&&ye(o,c,a)){var m=a[s][l];if(!m.isVisible||"mountain"!==m.type){var d,p={from:{x:o,y:c},direction:u,id:ge()(),type:"all"===r?"MOVE_ALL":"MOVE_HALF"};d=p,F.emit("addCommand",d),I.dispatch(b({x:l,y:s})),I.dispatch(h([].concat(Object(g.a)(t),[p])))}}},ye=function(e,t,a){return e>=0&&e<a[0].length&&t>=0&&t<a.length},be=function(e,t,a){var n;return"w"===a&&(n="u",t--),"s"===a&&(t++,n="d"),"a"===a&&(e--,n="l"),"d"===a&&(e++,n="r"),{x:e,y:t,direction:n}},he=function(e,t){return I.dispatch(b({x:e,y:t}))},Ee=["w","s","a","d"],we=function(e){var t=e.key;if(Ee.includes(t))return ve(t);"e"===t&&Oe(),"q"===t&&je()},Oe=function(){var e=ce(I.getState());if(0!==e.length){var t=e[e.length-1],a=[t.id];if(t.from){var n=t.from,r=n.x,o=n.y;he(r,o)}U(a),I.dispatch(E(a))}},je=function(){var e=ce(I.getState());if(0!==e.length){var t=e.map((function(e){return e.id}));U(t),I.dispatch(E(t))}},_e=c.a.memo((function(e){var t=e.field,a=e.commands,n=e.seeAll,r=Object(Y.c)(X),o=Object(Y.c)(ie),i=Object(Y.c)(oe),l=Object(Y.c)(me),s=t.type,u=t.owner,m=t.units,d=t.x,p=t.y,f=t.isVisible,g=r.socketId===u,v=i.x===d&&i.y===p;return c.a.createElement("div",{onClick:function(){if(g){if(console.log(l),v&&"all"===l)return I.dispatch({type:"game.setMoveType",payload:"half"});he(d,p)}},style:{backgroundColor:n||!0!==!f?"n"===u?"grey":o[u]:"#202020",backgroundImage:Ce(s,f||n)},className:pe()("board-tile",{clicable:g,"selected-field":v})},v&&"half"===l?"50%":(n||!!f)&&null!=m&&m,a.map((function(e){return c.a.createElement("div",{className:xe(e)},function(e){switch(e.direction){case"u":return"\u2191";case"d":return"\u2193";case"l":return"\u2190";case"r":return"\u2192";default:return"x"}}(e))})))}),(function(e,t){return!!(Object(k.isEqual)(e.commands,t.commands)&&Object(k.isEqual)(e.field,t.field)&&Object(k.isEqual)(e.seeAll,t.seeAll))}));function Ce(e,t){var a="";return(t=t||window.debug)||"castle"!==e&&"mountain"!==e?"castle"===e?a="/city.png":"mountain"===e?a="/mountain.png":t&&"capitol"===e&&(a="/crown.png"):a="/obstacle.png","url(".concat("."+a,")")}function xe(e){switch(e.direction){case"u":return"arrow-container arrow-up";case"d":return"arrow-container arrow-down";case"l":return"arrow-container arrow-left";case"r":return"arrow-container arrow-right";default:return alert("command without direction")}}var Ne=function(){var e=Object(Y.c)(re),t=Object(Y.c)(ce),a=Object(Y.c)(le),n=function(e){var t=e.movementX,a=e.movementY;if(1===e.buttons){var n=document.getElementById("board"),r=n.style,o=r.left,c=r.top;n.style.left=Number(o.slice(0,-2))+t+"px",n.style.top=Number(c.slice(0,-2))+a+"px"}},r=function(e){var t=e.deltaY,a=document.getElementById("board"),n=Number(a.style.transform.slice(6,-1))+(t>0?-.1:.1);n>2||n<.5||(a.style.transform="scale(".concat(String(n).padEnd(3,".0"),")"))};Object(o.useEffect)((function(){return window.addEventListener("keypress",we),window.addEventListener("mousemove",n),window.addEventListener("mousewheel",r),function(){window.removeEventListener("keypress",we),window.removeEventListener("mousemove",n),window.removeEventListener("mousewheel",r)}}),[]);var i=t.reduce((function(e,t){var a="".concat(t.from.x,"-").concat(t.from.y);return e[a]||(e[a]=[]),e[a].push(t),e}),{});return c.a.createElement("div",null,c.a.createElement("div",{id:"board",className:"board-container",style:{left:"10px",top:"10px",transform:"scale(1)"}},e.map((function(e,t){return c.a.createElement("div",{key:t,className:"board-row "},e.map((function(e,t){return c.a.createElement(_e,{key:t,seeAll:"spectator"===a||!0===window.debug,commands:i["".concat(e.x,"-").concat(e.y)]||[],field:e})})))}))))},Se=a(87),Ie=a.n(Se),ke=a(382),Me=a(378),Ae=a(380),De=function(e){return e.settings.gameSettings},Te=V.a.Item,Re=ke.a.Option,Le=[{name:"Conquest",description:"Capture all opponent capitols"}],Pe=[{name:"Units Collector",descroption:"Gather the biggest army in whole state"},{name:"King of Castles",descroption:"Capture the castles around the whole world"},{name:"Territory Wars",descroption:"Rule the whole world"}],Ge=Object(k.debounce)((function(e){return function(e){return F.emit("setRoomSettings",e)}(e)}),500),Be=function(){var e,t=Object(Y.c)(De),a=Object(Y.c)(X),n=Object(Y.c)(ne),r=Object(Y.b)(),o=a.socketId===(null===(e=n[0])||void 0===e?void 0:e.socketId),i=t.mapWidth,l=t.mapHeight,s=t.gameMode,u=t.nonAggression,m=t.castlesDensity,d=t.mountainDensity,p=t.castleProduction,f=t.fieldProduction,g=t.turnDuration,v=function(e,t){r(function(e,t){return{type:"MODIFY_GAME_SETTING",payload:{settingName:e,value:t}}}(e,t)),Ge(De(I.getState()))},y=function(){return e=t,F.emit("start",e);var e};return a.roomId?c.a.createElement("div",{className:Ie.a["settings-wrapper"]},c.a.createElement("div",{className:Ie.a["settings-content-box"]},c.a.createElement(J.a,{onClick:function(){return y()},type:"primary",style:{width:"300px",marginTop:"10px"},disabled:!o},"Battle!"),c.a.createElement("div",{className:Ie.a["settings-list"]},c.a.createElement(Me.a,null,"Only Host Can Modify This Settings"),c.a.createElement(Me.a,null,"Map Dimmensions"),c.a.createElement("div",null,c.a.createElement(Te,{help:"Map Width: ".concat(i)},c.a.createElement(Ae.a,{disabled:!o,min:15,max:36,value:i,onChange:function(e){return v("mapWidth",e)}})),c.a.createElement(Te,{help:"Map Height: ".concat(l)},c.a.createElement(Ae.a,{disabled:!o,min:15,max:36,value:l,onChange:function(e){return v("mapHeight",e)}}))),c.a.createElement(Me.a,null,"Game Rules"),c.a.createElement(Te,{help:"Game Mode"},c.a.createElement(ke.a,{disabled:!o,value:s,onChange:function(e){return v("gameMode",e)}},Le.map((function(e){return c.a.createElement(Re,{value:e.name,key:e.name},e.name)})),Pe.map((function(e){return c.a.createElement(Re,{value:e.name,key:e.name,disabled:!0},e.name)})))),c.a.createElement(Te,{help:"Duration Of Non-Aggression Pact: ".concat(u)},c.a.createElement(Ae.a,{disabled:!o,min:0,max:300,step:10,value:u,onChange:function(e){return v("nonAggression",e)}})),c.a.createElement(Me.a,null,"Map Objects"),c.a.createElement("div",null,c.a.createElement(Te,{help:"Castles Density: ".concat(m)},c.a.createElement(Ae.a,{disabled:!o,min:0,max:1,step:.1,value:m,onChange:function(e){return v("castlesDensity",e)}})),c.a.createElement(Te,{help:"Mountains Density: ".concat(d)},c.a.createElement(Ae.a,{disabled:!o,min:0,max:1,step:.1,value:d,onChange:function(e){return v("mountainDensity",e)}}))),c.a.createElement(Me.a,null,"Other"),c.a.createElement("div",null,c.a.createElement(Te,{help:"Castles Units Production Time: ".concat(p)},c.a.createElement(Ae.a,{disabled:!o,min:1,max:60,step:1,value:p,onChange:function(e){return v("castleProduction",e)}})),c.a.createElement(Te,{help:"Field Units Production Time: ".concat(f)},c.a.createElement(Ae.a,{disabled:!o,min:1,max:60,step:1,value:f,onChange:function(e){return v("fieldProduction",e)}})),c.a.createElement(Te,{help:"Resp Turn Duration: ".concat(g," ms")},c.a.createElement(Ae.a,{disabled:!o,min:250,max:3e3,step:250,value:g,onChange:function(e){return v("turnDuration",e)}})))))):null},Fe=a(68),Ue=a.n(Fe),qe=function(){var e=Object(Y.c)(ne),t=Object(Y.c)(ie),a=Object(Y.c)(se),n=Object(Y.c)(ue),r=Object(Y.c)(le),o=Object(Y.c)(De).nonAggression,i=Object(Y.b)();return c.a.createElement("div",{className:Ue.a["info-panel"]},c.a.createElement("div",{className:pe()(Ue.a["grid-container"])},c.a.createElement("div",null),c.a.createElement("div",{className:Ue.a["room-header"]},"Player"),c.a.createElement("div",null,"Army"),c.a.createElement("div",null,"Lands"),e.map((function(e){var n,r;return c.a.createElement(c.a.Fragment,{key:e.socketId},c.a.createElement("div",null,c.a.createElement("div",{className:Ue.a["color-box"],style:{background:t[e.socketId]}})),c.a.createElement("div",null,"".concat(e.userName)),c.a.createElement("div",null,(null===(n=a[e.socketId])||void 0===n?void 0:n.units)||0),c.a.createElement("div",null,(null===(r=a[e.socketId])||void 0===r?void 0:r.lands)||0))}))),c.a.createElement("div",null,"Tour: ",n," / ",o),c.a.createElement("div",null,"spectator"===r&&c.a.createElement(J.a,{onClick:function(){return i(w("lobby"))},type:"danger",style:{width:"100%"}},"Back To Lobby!")))},He=a(119),Ve=a.n(He),We=a(383),Je=function(){var e=Object(o.useState)(100),t=Object(H.a)(e,2),a=t[0],i=t[1],l=function(e){i(e),function(e){P=e,n&&(n.volume=P),r&&(r.volume=P)}(e/100)};return c.a.createElement("div",{className:Ve.a["audio-panel"]},c.a.createElement(J.a,{onClick:function(){return l(a?0:100)},icon:c.a.createElement(We.a,null)}),c.a.createElement("div",{className:Ve.a["slider-wrapper"]},c.a.createElement(Ae.a,{min:0,max:100,onChange:l,value:a})))};a(374);var Ye=function(){var e=Object(Y.c)(le);return Object(o.useEffect)((function(){G(A)}),[]),c.a.createElement("div",null,c.a.createElement(Je,null),c.a.createElement(qe,null),c.a.createElement(ae,null),"lobby"===e&&c.a.createElement(c.a.Fragment,null,c.a.createElement(z,null),c.a.createElement(Be,null)),("fighter"===e||"spectator"===e)&&c.a.createElement(Ne,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(Y.a,{store:I},c.a.createElement(Ye,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},67:function(e,t,a){e.exports={"chat-wrapper":"LiveChat_chat-wrapper__3yyAJ","chat-history":"LiveChat_chat-history__2VHgG","chat-header":"LiveChat_chat-header__1SPj-","new-message":"LiveChat_new-message__1I6jr"}},68:function(e,t,a){e.exports={"info-panel":"GameInfo_info-panel__3NB7p","grid-container":"GameInfo_grid-container__1DJ7y","color-box":"GameInfo_color-box__kQ-B1"}},86:function(e,t,a){e.exports={"lobby-wrapper":"Lobby_lobby-wrapper__lDjyO","lobby-content-box":"Lobby_lobby-content-box__QuG4U",header:"Lobby_header__2r9_D"}},87:function(e,t,a){e.exports={"settings-wrapper":"Settings_settings-wrapper__1-tcm","settings-content-box":"Settings_settings-content-box__38rES","settings-list":"Settings_settings-list__3xNVK"}}},[[182,1,2]]]);
//# sourceMappingURL=main.db255eed.chunk.js.map